name: Duplicate-Package-Sample

on:
  push:
    branches:
      - main

jobs:
  duplicate:
    name: duplicate package sample
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Run duplicate script file
        run: bash ${GITHUB_WORKSPACE}/duplicate_package_sample.sh

      - name: Commit and Push
        run: |
          git config --global user.email $git_email
          git config --global user.name "${{ github.actor }}"
          git add ./src/UnityPackages/io.chainsafe.web3-unity/Samples~/Web3.Unity/. -f
          git diff-index --cached --quiet HEAD || git commit -m "Auto-duplicate Package Samples"
          git push
        env:
          git_email: "${{ github.actor }}@users.noreply.github.com"