name: Duplicate Package Samples Workflow

on:
  pull_request:
    branches: [ main ]

jobs:
  duplicate:
    name: Duplicate samples job ðŸ‘¯
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
      with:
        ref: ${{ github.event.pull_request.head.ref }}
    - name: Duplicate Web3 Unity Samples
      run: |
        git config user.email $git_email
        git config user.name "${{ github.actor }}"
        
        export SOURCE_PATH=
        export DESTINATION_DIRECTORY=
        export DESTINATION_PATH=
        
        for entry in "${DUPLICATE_SAMPLE_VARS[@]}"
        do
          IFS=':' read -ra dirs <<< "$entry"
          SOURCE_PATH=${dirs[0]}
          DESTINATION_DIRECTORY=${dirs[1]}
          
          SOURCE_PATH="${GITHUB_WORKSPACE}/$SOURCE_PATH/$(ls "$SOURCE_PATH" | head -n 1)/$DESTINATION_DIRECTORY"
        
          DESTINATION_PATH="${GITHUB_WORKSPACE}/${dirs[2]}"
          
          rm -rf "$DESTINATION_PATH"
          mkdir -p "$DESTINATION_PATH"
          cp -r "$SOURCE_PATH" "$DESTINATION_PATH"
        
          git add "$DESTINATION_PATH." -f
        done
        
        echo ${DUPLICATE_SAMPLE_VARS[0]}
        export first=${DUPLICATE_SAMPLE_VARS[0]}
        echo $first
        IFS=':' read -ra arr <<< "first"
        echo ${arr[0]}
        echo ${arr[1]}
        echo ${arr[2]}
        
        git diff-index --cached --quiet HEAD || git commit -m "Auto-duplicate Packages Samples"
        git push
      env:
        git_email: "${{ github.actor }}@users.noreply.github.com"